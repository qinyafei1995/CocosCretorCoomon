window.__require=function t(e,i,o){function n(c,a){if(!i[c]){if(!e[c]){var l=c.split("/");if(l=l[l.length-1],!e[l]){var r="function"==typeof __require&&__require;if(!a&&r)return r(l,!0);if(s)return s(l,!0);throw new Error("Cannot find module '"+c+"'")}c=l}var h=i[c]={exports:{}};e[c][0].call(h.exports,function(t){return n(e[c][1][t]||t)},h,h.exports,t,e,i,o)}return i[c].exports}for(var s="function"==typeof __require&&__require,c=0;c<o.length;c++)n(o[c]);return n}({BasePanel:[function(t,e,i){"use strict";cc._RF.push(e,"279ceIlAMhDJq4fXphC6H6L","BasePanel"),Object.defineProperty(i,"__esModule",{value:!0});var o=cc._decorator,n=o.ccclass,s=(o.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.open=function(){this.node.active=!0},e.prototype.colse=function(){this.node.active=!1},e=__decorate([n],e)}(cc.Component));i.default=s,cc._RF.pop()},{}],Demo:[function(t,e,i){"use strict";cc._RF.push(e,"24f9a6AGQtFELSZgdyzQhiQ","Demo"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("./BasePanel"),n=cc._decorator,s=n.ccclass,c=n.property,a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isInvite=!0,e.isHistoryRank=!0,e.isFriendRank=!0,e.isOverRank=!0,e._panelMng={},e}return __extends(e,t),e.prototype.onLoad=function(){this.initPanel(),this.initMsg()},e.prototype.initPanel=function(){this.isInvite&&this.loadPanel("invitePanel",null),this.isHistoryRank&&this.loadPanel("historyPanel",null),this.isFriendRank&&this.loadPanel("friendRankPanel",null),this.isOverRank&&this.loadPanel("overRankPanel",null)},e.prototype.loadPanel=function(t,e){var i=this;cc.loader.loadRes("prefabs/"+t,cc.Prefab,function(n,s){if(n)console.error("\u52a0\u8f7d\u8d44\u6e90\u9519\u8bef, panelName ===>",t);else if(s){var c=cc.instantiate(s);i.node.addChild(c),c.active=!1,i._panelMng[t]=c.getComponent(o.default),i._panelMng[t].init(),"function"==typeof e&&e(c)}})},e.prototype.initMsg=function(){var t=this;cc.sys.platform==cc.sys.WECHAT_GAME&&(console.log("\u5b50\u57df==>",window.wx),window.wx.onMessage(function(e){console.log("\u8fd9\u91cc\u662f\u5b50\u57df==>",e);var i=e.msgType;if("string"==typeof i&&(i=parseInt(i)),t.isInvite&&i>=100&&i<=199)switch(i){case 100:t._panelMng.invitePanel.open();break;case 101:t._panelMng.invitePanel.close();break;case 102:t._panelMng.invitePanel.updateInvite()}if(t.isHistoryRank&&i>=200&&i<=299)switch(i){case 100:t._panelMng.invitePanel.open();break;case 101:case 102:t._panelMng.invitePanel.close()}t.isHistoryRank,t.isHistoryRank}))},e.prototype.inviteMsg=function(){},__decorate([c({displayName:"\u5f00\u542f >\u9080\u8bf7< \u754c\u9762"})],e.prototype,"isInvite",void 0),__decorate([c({displayName:"\u5f00\u542f >\u5386\u53f2< \u6392\u884c"})],e.prototype,"isHistoryRank",void 0),__decorate([c({displayName:"\u5f00\u542f >\u597d\u53cb< \u6392\u884c"})],e.prototype,"isFriendRank",void 0),__decorate([c({displayName:"\u5f00\u542f >\u7ed3\u675f< \u6392\u884c"})],e.prototype,"isOverRank",void 0),e=__decorate([s],e)}(cc.Component);i.default=a,cc._RF.pop()},{"./BasePanel":"BasePanel"}],FriendRankPanel:[function(t,e,i){"use strict";cc._RF.push(e,"4c2f8ukf4lN8qJZH9TwE2AG","FriendRankPanel"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("./BasePanel"),n=cc._decorator,s=n.ccclass,c=n.property,a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e.text="hello",e}return __extends(e,t),e.prototype.start=function(){},__decorate([c(cc.Label)],e.prototype,"label",void 0),__decorate([c],e.prototype,"text",void 0),e=__decorate([s],e)}(o.default);i.default=a,cc._RF.pop()},{"./BasePanel":"BasePanel"}],InvitePanel:[function(t,e,i){"use strict";cc._RF.push(e,"ef802d0+axCDrJhqcZTxSeM","InvitePanel"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("./BasePanel"),n=t("../Common/SubTools"),s=cc._decorator,c=s.ccclass,a=(s.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._itemList=Array(),e}return __extends(e,t),e.prototype.init=function(){this._itemList=this.node.getChildByName("layout").children,this.updateInvite()},e.prototype.clickEvent=function(t,e){},e.prototype.updateInvite=function(){n.default.getFriendList(function(t){console.log("\u83b7\u53d6\u540e\u7684\u597d\u53cb\u6570\u636e",t)})},e=__decorate([c],e)}(o.default));i.default=a,cc._RF.pop()},{"../Common/SubTools":"SubTools","./BasePanel":"BasePanel"}],ListItem:[function(t,e,i){"use strict";cc._RF.push(e,"40b3dqRMsxDFI2JbEpZb/Am","ListItem"),Object.defineProperty(i,"__esModule",{value:!0});var o,n=cc._decorator,s=n.ccclass,c=n.property,a=n.disallowMultiple,l=n.menu,r=n.executionOrder;(function(t){t[t.NONE=0]="NONE",t[t.TOGGLE=1]="TOGGLE",t[t.SWITCH=2]="SWITCH"})(o||(o={}));var h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.icon=null,e.title=null,e.selectedMode=o.NONE,e.selectedFlag=null,e.selectedSpriteFrame=null,e._unselectedSpriteFrame=null,e.adaptiveSize=!1,e._selected=!1,e._eventReg=!1,e}return __extends(e,t),Object.defineProperty(e.prototype,"selected",{get:function(){return this._selected},set:function(t){if(this._selected=t,this.selectedFlag)switch(this.selectedMode){case o.TOGGLE:this.selectedFlag.active=t;break;case o.SWITCH:var e=this.selectedFlag.getComponent(cc.Sprite);e&&(e.spriteFrame=t?this.selectedSpriteFrame:this._unselectedSpriteFrame)}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"btnCom",{get:function(){return this._btnCom||(this._btnCom=this.node.getComponent(cc.Button)),this._btnCom},enumerable:!0,configurable:!0}),e.prototype.onLoad=function(){if(this.selectedMode==o.SWITCH){var t=this.selectedFlag.getComponent(cc.Sprite);this._unselectedSpriteFrame=t.spriteFrame}},e.prototype.onDestroy=function(){this.node.off(cc.Node.EventType.SIZE_CHANGED,this._onSizeChange,this)},e.prototype._registerEvent=function(){this._eventReg||(this.btnCom&&this.list.selectedMode>0&&this.btnCom.clickEvents.unshift(this.createEvt(this,"onClickThis")),this.adaptiveSize&&this.node.on(cc.Node.EventType.SIZE_CHANGED,this._onSizeChange,this),this._eventReg=!0)},e.prototype._onSizeChange=function(){this.list._onItemAdaptive(this.node)},e.prototype.createEvt=function(t,e,i){if(void 0===i&&(i=null),t.isValid){t.comName=t.comName||t.name.match(/\<(.*?)\>/g).pop().replace(/\<|>/g,"");var o=new cc.Component.EventHandler;return o.target=i||t.node,o.component=t.comName,o.handler=e,o}},e.prototype.showAni=function(t,e,i){var o,n=this;switch(t){case 0:o=[cc.scaleTo(.2,.7),cc.moveBy(.3,0,2*this.node.height)];break;case 1:o=[cc.scaleTo(.2,.7),cc.moveBy(.3,2*this.node.width,0)];break;case 2:o=[cc.scaleTo(.2,.7),cc.moveBy(.3,0,-2*this.node.height)];break;case 3:o=[cc.scaleTo(.2,.7),cc.moveBy(.3,-2*this.node.width,0)];break;default:o=[cc.scaleTo(.3,.1)]}(e||i)&&o.push(cc.callFunc(function(){if(i){n.list._delSingleItem(n.node);for(var t=n.list.displayData.length-1;t>=0;t--)if(n.list.displayData[t].id==n.listId){n.list.displayData.splice(t,1);break}}e()})),this.node.runAction(cc.sequence(o))},e.prototype.onClickThis=function(){this.list.selectedId=this.listId},__decorate([c({type:cc.Sprite,tooltip:!1})],e.prototype,"icon",void 0),__decorate([c({type:cc.Node,tooltip:!1})],e.prototype,"title",void 0),__decorate([c({type:cc.Enum(o),tooltip:!1})],e.prototype,"selectedMode",void 0),__decorate([c({type:cc.Node,tooltip:!1,visible:function(){return this.selectedMode>o.NONE}})],e.prototype,"selectedFlag",void 0),__decorate([c({type:cc.SpriteFrame,tooltip:!1,visible:function(){return this.selectedMode==o.SWITCH}})],e.prototype,"selectedSpriteFrame",void 0),__decorate([c({tooltip:!1})],e.prototype,"adaptiveSize",void 0),e=__decorate([s,a(),l("\u81ea\u5b9a\u4e49\u7ec4\u4ef6/List Item"),r(-5001)],e)}(cc.Component);i.default=h,cc._RF.pop()},{}],List:[function(t,e,i){"use strict";cc._RF.push(e,"03941S/8c5JIpXAo74z1CER","List"),Object.defineProperty(i,"__esModule",{value:!0});var o,n,s,c=cc._decorator,a=c.ccclass,l=c.property,r=c.disallowMultiple,h=c.menu,d=c.executionOrder,_=c.requireComponent,u=t("./ListItem");(function(t){t[t.NODE=1]="NODE",t[t.PREFAB=2]="PREFAB"})(o||(o={})),function(t){t[t.NORMAL=1]="NORMAL",t[t.ADHERING=2]="ADHERING",t[t.PAGE=3]="PAGE"}(n||(n={})),function(t){t[t.NONE=0]="NONE",t[t.SINGLE=1]="SINGLE",t[t.MULT=2]="MULT"}(s||(s={}));var p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.templateType=o.NODE,e.tmpNode=null,e.tmpPrefab=null,e._slideMode=n.NORMAL,e.pageDistance=.3,e.pageChangeEvent=new cc.Component.EventHandler,e._virtual=!0,e.cyclic=!1,e.lackCenter=!1,e.lackSlide=!1,e._updateRate=0,e.frameByFrameRenderNum=0,e.renderEvent=new cc.Component.EventHandler,e.selectedMode=s.NONE,e.repeatEventSingle=!1,e.selectedEvent=null,e._selectedId=-1,e._forceUpdate=!1,e._updateDone=!0,e._numItems=0,e._inited=!1,e._needUpdateWidget=!1,e._aniDelRuning=!1,e._doneAfterUpdate=!1,e.adhering=!1,e._adheringBarrier=!1,e.curPageNum=0,e}return __extends(e,t),Object.defineProperty(e.prototype,"slideMode",{get:function(){return this._slideMode},set:function(t){this._slideMode=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"virtual",{get:function(){return this._virtual},set:function(t){null!=t&&(this._virtual=t),0!=this._numItems&&this._onScrolling()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"updateRate",{get:function(){return this._updateRate},set:function(t){t>=0&&t<=6&&(this._updateRate=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectedId",{get:function(){return this._selectedId},set:function(t){var e,i=this;switch(i.selectedMode){case s.SINGLE:if(!i.repeatEventSingle&&t==i._selectedId)return;e=i.getItemByListId(t);var o=void 0;if(i._selectedId>=0?i._lastSelectedId=i._selectedId:i._lastSelectedId=null,i._selectedId=t,e&&((o=e.getComponent(u.default)).selected=!0),i._lastSelectedId>=0&&i._lastSelectedId!=i._selectedId){var n=i.getItemByListId(i._lastSelectedId);n&&(n.getComponent(u.default).selected=!1)}i.selectedEvent&&cc.Component.EventHandler.emitEvents([i.selectedEvent],e,t%this._actualNumItems,null==i._lastSelectedId?null:i._lastSelectedId%this._actualNumItems);break;case s.MULT:if(!(e=i.getItemByListId(t)))return;o=e.getComponent(u.default);i._selectedId>=0&&(i._lastSelectedId=i._selectedId),i._selectedId=t;var c=!o.selected;o.selected=c;var a=i.multSelected.indexOf(t);c&&a<0?i.multSelected.push(t):!c&&a>=0&&i.multSelected.splice(a,1),i.selectedEvent&&cc.Component.EventHandler.emitEvents([i.selectedEvent],e,t%this._actualNumItems,null==i._lastSelectedId?null:i._lastSelectedId%this._actualNumItems,c)}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numItems",{get:function(){return this._actualNumItems},set:function(t){var e=this;if(e.checkInited(!1))if(null==t||t<0)cc.error("numItems set the wrong::",t);else if(e._actualNumItems=e._numItems=t,e._forceUpdate=!0,e._virtual)e._resizeContent(),e.cyclic&&(e._numItems=e._cyclicNum*e._numItems),e._onScrolling(),e.frameByFrameRenderNum||e.slideMode!=n.PAGE||(e.curPageNum=e.nearestListId);else{var i=e.content.getComponent(cc.Layout);if(i&&(i.enabled=!0),e._delRedundantItem(),e.firstListId=0,e.frameByFrameRenderNum>0){for(var o=e.frameByFrameRenderNum>e._numItems?e._numItems:e.frameByFrameRenderNum,s=0;s<o;s++)e._createOrUpdateItem2(s);e.frameByFrameRenderNum<e._numItems&&(e._updateCounter=e.frameByFrameRenderNum,e._updateDone=!1)}else{for(s=0;s<t;s++)e._createOrUpdateItem2(s);e.displayItemNum=t}}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scrollView",{get:function(){return this._scrollView},enumerable:!0,configurable:!0}),e.prototype.onLoad=function(){this._init()},e.prototype.onDestroy=function(){var t=this;for(t._itemTmp&&t._itemTmp.isValid&&t._itemTmp.destroy(),t.tmpNode&&t.tmpNode.isValid&&t.tmpNode.destroy();t._pool.size();){t._pool.get().destroy()}},e.prototype.onEnable=function(){this._registerEvent(),this._init()},e.prototype.onDisable=function(){this._unregisterEvent()},e.prototype._registerEvent=function(){var t=this;t.node.on(cc.Node.EventType.TOUCH_START,t._onTouchStart,t,!0),t.node.on("touch-up",t._onTouchUp,t),t.node.on(cc.Node.EventType.TOUCH_CANCEL,t._onTouchCancelled,t,!0),t.node.on("scroll-began",t._onScrollBegan,t,!0),t.node.on("scroll-ended",t._onScrollEnded,t,!0),t.node.on("scrolling",t._onScrolling,t,!0),t.node.on(cc.Node.EventType.SIZE_CHANGED,t._onSizeChanged,t)},e.prototype._unregisterEvent=function(){var t=this;t.node.off(cc.Node.EventType.TOUCH_START,t._onTouchStart,t,!0),t.node.off("touch-up",t._onTouchUp,t),t.node.off(cc.Node.EventType.TOUCH_CANCEL,t._onTouchCancelled,t,!0),t.node.off("scroll-began",t._onScrollBegan,t,!0),t.node.off("scroll-ended",t._onScrollEnded,t,!0),t.node.off("scrolling",t._onScrolling,t,!0),t.node.off(cc.Node.EventType.SIZE_CHANGED,t._onSizeChanged,t)},e.prototype._init=function(){var t=this;if(!t._inited)if(t._scrollView=t.node.getComponent(cc.ScrollView),t.content=t._scrollView.content,t.content){switch(t._layout=t.content.getComponent(cc.Layout),t._align=t._layout.type,t._resizeMode=t._layout.resizeMode,t._startAxis=t._layout.startAxis,t._topGap=t._layout.paddingTop,t._rightGap=t._layout.paddingRight,t._bottomGap=t._layout.paddingBottom,t._leftGap=t._layout.paddingLeft,t._columnGap=t._layout.spacingX,t._lineGap=t._layout.spacingY,t._colLineNum,t._verticalDir=t._layout.verticalDirection,t._horizontalDir=t._layout.horizontalDirection,t.setTemplateItem(cc.instantiate(t.templateType==o.PREFAB?t.tmpPrefab:t.tmpNode)),t._slideMode!=n.ADHERING&&t._slideMode!=n.PAGE||(t._scrollView.inertia=!1,t._scrollView._onMouseWheel=function(){}),t.virtual||(t.lackCenter=!1),t._lastDisplayData=[],t.displayData=[],t._pool=new cc.NodePool,t._forceUpdate=!1,t._updateCounter=0,t._updateDone=!0,t.curPageNum=0,t.cyclic&&(t._scrollView._processAutoScrolling=this._processAutoScrolling.bind(t),t._scrollView._startBounceBackIfNeeded=function(){return!1}),t._align){case cc.Layout.Type.HORIZONTAL:switch(t._horizontalDir){case cc.Layout.HorizontalDirection.LEFT_TO_RIGHT:t._alignCalcType=1;break;case cc.Layout.HorizontalDirection.RIGHT_TO_LEFT:t._alignCalcType=2}break;case cc.Layout.Type.VERTICAL:switch(t._verticalDir){case cc.Layout.VerticalDirection.TOP_TO_BOTTOM:t._alignCalcType=3;break;case cc.Layout.VerticalDirection.BOTTOM_TO_TOP:t._alignCalcType=4}break;case cc.Layout.Type.GRID:switch(t._startAxis){case cc.Layout.AxisDirection.HORIZONTAL:switch(t._verticalDir){case cc.Layout.VerticalDirection.TOP_TO_BOTTOM:t._alignCalcType=3;break;case cc.Layout.VerticalDirection.BOTTOM_TO_TOP:t._alignCalcType=4}break;case cc.Layout.AxisDirection.VERTICAL:switch(t._horizontalDir){case cc.Layout.HorizontalDirection.LEFT_TO_RIGHT:t._alignCalcType=1;break;case cc.Layout.HorizontalDirection.RIGHT_TO_LEFT:t._alignCalcType=2}}}t.content.removeAllChildren(),t._inited=!0}else cc.error(t.node.name+"'s cc.ScrollView unset content!")},e.prototype._processAutoScrolling=function(t){this._scrollView._autoScrollAccumulatedTime+=1*t;var e=Math.min(1,this._scrollView._autoScrollAccumulatedTime/this._scrollView._autoScrollTotalTime);if(this._scrollView._autoScrollAttenuate){var i=e-1;e=i*i*i*i*i+1}var o=this._scrollView._autoScrollStartPosition.add(this._scrollView._autoScrollTargetDelta.mul(e)),n=this._scrollView.getScrollEndedEventTiming(),s=Math.abs(e-1)<=n;Math.abs(e-1)<=this._scrollView.getScrollEndedEventTiming()&&!this._scrollView._isScrollEndedWithThresholdEventFired&&(this._scrollView._dispatchEvent("scroll-ended-with-threshold"),this._scrollView._isScrollEndedWithThresholdEventFired=!0),s&&(this._scrollView._autoScrolling=!1);var c=o.sub(this._scrollView.getContentPosition());this._scrollView._moveContent(this._scrollView._clampDelta(c),s),this._scrollView._dispatchEvent("scrolling"),this._scrollView._autoScrolling||(this._scrollView._isBouncing=!1,this._scrollView._scrolling=!1,this._scrollView._dispatchEvent("scroll-ended"))},e.prototype.setTemplateItem=function(t){if(t){var e=this;e._itemTmp=t,e._resizeMode==cc.Layout.ResizeMode.CHILDREN?e._itemSize=e._layout.cellSize:e._itemSize=cc.size(t.width,t.height);var i=t.getComponent(u.default),o=!1;switch(i||(o=!0),o&&(e.selectedMode=s.NONE),(i=t.getComponent(cc.Widget))&&i.enabled&&(e._needUpdateWidget=!0),e.selectedMode==s.MULT&&(e.multSelected=[]),e._align){case cc.Layout.Type.HORIZONTAL:e._colLineNum=1,e._sizeType=!1;break;case cc.Layout.Type.VERTICAL:e._colLineNum=1,e._sizeType=!0;break;case cc.Layout.Type.GRID:switch(e._startAxis){case cc.Layout.AxisDirection.HORIZONTAL:var n=e.content.width-e._leftGap-e._rightGap;e._colLineNum=Math.floor((n+e._columnGap)/(e._itemSize.width+e._columnGap)),e._sizeType=!0;break;case cc.Layout.AxisDirection.VERTICAL:var c=e.content.height-e._topGap-e._bottomGap;e._colLineNum=Math.floor((c+e._lineGap)/(e._itemSize.height+e._lineGap)),e._sizeType=!1}}}},e.prototype.checkInited=function(t){return void 0===t&&(t=!0),!!this._inited||(t&&cc.error("List initialization not completed!"),!1)},e.prototype._resizeContent=function(){var t,e=this;switch(e._align){case cc.Layout.Type.HORIZONTAL:if(e._customSize){var i=e._getFixedSize(null);t=e._leftGap+i.val+e._itemSize.width*(e._numItems-i.count)+e._columnGap*(e._numItems-1)+e._rightGap}else t=e._leftGap+e._itemSize.width*e._numItems+e._columnGap*(e._numItems-1)+e._rightGap;break;case cc.Layout.Type.VERTICAL:if(e._customSize){i=e._getFixedSize(null);t=e._topGap+i.val+e._itemSize.height*(e._numItems-i.count)+e._lineGap*(e._numItems-1)+e._bottomGap}else t=e._topGap+e._itemSize.height*e._numItems+e._lineGap*(e._numItems-1)+e._bottomGap;break;case cc.Layout.Type.GRID:switch(e.lackCenter&&(e.lackCenter=!1),e._startAxis){case cc.Layout.AxisDirection.HORIZONTAL:var o=Math.ceil(e._numItems/e._colLineNum);t=e._topGap+e._itemSize.height*o+e._lineGap*(o-1)+e._bottomGap;break;case cc.Layout.AxisDirection.VERTICAL:var n=Math.ceil(e._numItems/e._colLineNum);t=e._leftGap+e._itemSize.width*n+e._columnGap*(n-1)+e._rightGap}}var s=e.content.getComponent(cc.Layout);if(s&&(s.enabled=!1),e._allItemSize=t,e._allItemSizeNoEdge=e._allItemSize-(e._sizeType?e._topGap+e._bottomGap:e._leftGap+e._rightGap),e.cyclic){var c=e._sizeType?e.node.height:e.node.width;e._cyclicPos1=0,c-=e._cyclicPos1,e._cyclicNum=Math.ceil(c/e._allItemSizeNoEdge)+1;var a=e._sizeType?e._lineGap:e._columnGap;e._cyclicPos2=e._cyclicPos1+e._allItemSizeNoEdge+a,e._cyclicAllItemSize=e._allItemSize+e._allItemSizeNoEdge*(e._cyclicNum-1)+a*(e._cyclicNum-1),e._cycilcAllItemSizeNoEdge=e._allItemSizeNoEdge*e._cyclicNum,e._cycilcAllItemSizeNoEdge+=a*(e._cyclicNum-1)}e._lack=!e.cyclic&&e._allItemSize<(e._sizeType?e.node.height:e.node.width);var l=e._lack&&e.lackCenter||!e.lackSlide?.1:0,r=e._lack?(e._sizeType?e.node.height:e.node.width)-l:e.cyclic?e._cyclicAllItemSize:e._allItemSize;r<0&&(r=0),e._sizeType?e.content.height=r:e.content.width=r},e.prototype._onScrolling=function(t){if(void 0===t&&(t=null),null==this.frameCount&&(this.frameCount=this._updateRate),!this._forceUpdate&&t&&"scroll-ended"!=t.type&&this.frameCount>0)this.frameCount--;else if(this.frameCount=this._updateRate,!this._aniDelRuning){if(this.cyclic){var e=this.content.getPosition();e=this._sizeType?e.y:e.x;var i=this._allItemSizeNoEdge+(this._sizeType?this._lineGap:this._columnGap),o=this._sizeType?cc.v2(0,i):cc.v2(i,0);switch(this._alignCalcType){case 1:e>-this._cyclicPos1?(this.content.x=-this._cyclicPos2,this._scrollView.isAutoScrolling()&&(this._scrollView._autoScrollStartPosition=this._scrollView._autoScrollStartPosition.sub(o))):e<-this._cyclicPos2&&(this.content.x=-this._cyclicPos1,this._scrollView.isAutoScrolling()&&(this._scrollView._autoScrollStartPosition=this._scrollView._autoScrollStartPosition.add(o)));break;case 2:e<this._cyclicPos1?(this.content.x=this._cyclicPos2,this._scrollView.isAutoScrolling()&&(this._scrollView._autoScrollStartPosition=this._scrollView._autoScrollStartPosition.add(o))):e>this._cyclicPos2&&(this.content.x=this._cyclicPos1,this._scrollView.isAutoScrolling()&&(this._scrollView._autoScrollStartPosition=this._scrollView._autoScrollStartPosition.sub(o)));break;case 3:e<this._cyclicPos1?(this.content.y=this._cyclicPos2,this._scrollView.isAutoScrolling()&&(this._scrollView._autoScrollStartPosition=this._scrollView._autoScrollStartPosition.add(o))):e>this._cyclicPos2&&(this.content.y=this._cyclicPos1,this._scrollView.isAutoScrolling()&&(this._scrollView._autoScrollStartPosition=this._scrollView._autoScrollStartPosition.sub(o)));break;case 4:e>-this._cyclicPos1?(this.content.y=-this._cyclicPos2,this._scrollView.isAutoScrolling()&&(this._scrollView._autoScrollStartPosition=this._scrollView._autoScrollStartPosition.sub(o))):e<-this._cyclicPos2&&(this.content.y=-this._cyclicPos1,this._scrollView.isAutoScrolling()&&(this._scrollView._autoScrollStartPosition=this._scrollView._autoScrollStartPosition.add(o)))}}var n,s,c,a;if(this._calcViewPos(),this._sizeType?(n=this.viewTop,c=this.viewBottom):(s=this.viewRight,a=this.viewLeft),this._virtual){this.displayData=[];var l=void 0,r=0,h=this._numItems-1;if(this._customSize)for(var d=!1;r<=h&&!d;r++)switch(l=this._calcItemPos(r),this._align){case cc.Layout.Type.HORIZONTAL:l.right>=a&&l.left<=s?this.displayData.push(l):0!=r&&this.displayData.length>0&&(d=!0);break;case cc.Layout.Type.VERTICAL:l.bottom<=n&&l.top>=c?this.displayData.push(l):0!=r&&this.displayData.length>0&&(d=!0);break;case cc.Layout.Type.GRID:switch(this._startAxis){case cc.Layout.AxisDirection.HORIZONTAL:l.bottom<=n&&l.top>=c?this.displayData.push(l):0!=r&&this.displayData.length>0&&(d=!0);break;case cc.Layout.AxisDirection.VERTICAL:l.right>=a&&l.left<=s?this.displayData.push(l):0!=r&&this.displayData.length>0&&(d=!0)}}else{var _=this._itemSize.width+this._columnGap,u=this._itemSize.height+this._lineGap;switch(this._alignCalcType){case 1:r=(a+this._leftGap)/_,h=(s+this._rightGap)/_;break;case 2:r=(-s-this._rightGap)/_,h=(-a-this._leftGap)/_;break;case 3:r=(-n-this._topGap)/u,h=(-c-this._bottomGap)/u;break;case 4:r=(c+this._bottomGap)/u,h=(n+this._topGap)/u}for(r=Math.floor(r)*this._colLineNum,h=Math.ceil(h)*this._colLineNum,h--,r<0&&(r=0),h>=this._numItems&&(h=this._numItems-1);r<=h;r++)this.displayData.push(this._calcItemPos(r))}if(this._delRedundantItem(),this.displayData.length<=0||!this._numItems)return void(this._lastDisplayData=[]);this.firstListId=this.displayData[0].id,this.displayItemNum=this.displayData.length;var p=this._lastDisplayData.length,m=this.displayItemNum!=p;if(m&&(this.frameByFrameRenderNum>0&&this._lastDisplayData.sort(function(t,e){return t-e}),m=this.firstListId!=this._lastDisplayData[0]||this.displayData[this.displayItemNum-1].id!=this._lastDisplayData[p-1]),this._forceUpdate||m)if(this.frameByFrameRenderNum>0)this._numItems>0?(this._updateDone?this._updateCounter=0:this._doneAfterUpdate=!0,this._updateDone=!1):(this._updateCounter=0,this._updateDone=!0);else{this._lastDisplayData=[];for(var f=0;f<this.displayItemNum;f++)this._createOrUpdateItem(this.displayData[f]);this._forceUpdate=!1}this._calcNearestItem()}}},e.prototype._calcViewPos=function(){var t=this.content.getPosition();switch(this._alignCalcType){case 1:this.elasticLeft=t.x>0?t.x:0,this.viewLeft=(t.x<0?-t.x:0)-this.elasticLeft,this.viewRight=this.viewLeft+this.node.width,this.elasticRight=this.viewRight>this.content.width?Math.abs(this.viewRight-this.content.width):0,this.viewRight+=this.elasticRight;break;case 2:this.elasticRight=t.x<0?-t.x:0,this.viewRight=(t.x>0?-t.x:0)+this.elasticRight,this.viewLeft=this.viewRight-this.node.width,this.elasticLeft=this.viewLeft<-this.content.width?Math.abs(this.viewLeft+this.content.width):0,this.viewLeft-=this.elasticLeft;break;case 3:this.elasticTop=t.y<0?Math.abs(t.y):0,this.viewTop=(t.y>0?-t.y:0)+this.elasticTop,this.viewBottom=this.viewTop-this.node.height,this.elasticBottom=this.viewBottom<-this.content.height?Math.abs(this.viewBottom+this.content.height):0,this.viewBottom+=this.elasticBottom;break;case 4:this.elasticBottom=t.y>0?Math.abs(t.y):0,this.viewBottom=(t.y<0?-t.y:0)-this.elasticBottom,this.viewTop=this.viewBottom+this.node.height,this.elasticTop=this.viewTop>this.content.height?Math.abs(this.viewTop-this.content.height):0,this.viewTop-=this.elasticTop}},e.prototype._calcItemPos=function(t){var e,i,o,n,s,c,a,l;switch(this._align){case cc.Layout.Type.HORIZONTAL:switch(this._horizontalDir){case cc.Layout.HorizontalDirection.LEFT_TO_RIGHT:if(this._customSize){var r=this._getFixedSize(t);s=this._leftGap+(this._itemSize.width+this._columnGap)*(t-r.count)+(r.val+this._columnGap*r.count),e=(h=this._customSize[t])>0?h:this._itemSize.width}else s=this._leftGap+(this._itemSize.width+this._columnGap)*t,e=this._itemSize.width;if(c=s+e,this.lackCenter)s+=d=this.content.width/2-this._allItemSizeNoEdge/2,c+=d;return{id:t,left:s,right:c,x:s+this._itemTmp.anchorX*e,y:this._itemTmp.y};case cc.Layout.HorizontalDirection.RIGHT_TO_LEFT:if(this._customSize){r=this._getFixedSize(t);c=-this._rightGap-(this._itemSize.width+this._columnGap)*(t-r.count)-(r.val+this._columnGap*r.count),e=(h=this._customSize[t])>0?h:this._itemSize.width}else c=-this._rightGap-(this._itemSize.width+this._columnGap)*t,e=this._itemSize.width;if(s=c-e,this.lackCenter)s-=d=this.content.width/2-this._allItemSizeNoEdge/2,c-=d;return{id:t,right:c,left:s,x:s+this._itemTmp.anchorX*e,y:this._itemTmp.y}}break;case cc.Layout.Type.VERTICAL:switch(this._verticalDir){case cc.Layout.VerticalDirection.TOP_TO_BOTTOM:if(this._customSize){r=this._getFixedSize(t);o=-this._topGap-(this._itemSize.height+this._lineGap)*(t-r.count)-(r.val+this._lineGap*r.count),i=(h=this._customSize[t])>0?h:this._itemSize.height}else o=-this._topGap-(this._itemSize.height+this._lineGap)*t,i=this._itemSize.height;if(n=o-i,this.lackCenter)o-=d=this.content.height/2-this._allItemSizeNoEdge/2,n-=d;return{id:t,top:o,bottom:n,x:this._itemTmp.x,y:n+this._itemTmp.anchorY*i};case cc.Layout.VerticalDirection.BOTTOM_TO_TOP:if(this._customSize){var h;r=this._getFixedSize(t);n=this._bottomGap+(this._itemSize.height+this._lineGap)*(t-r.count)+(r.val+this._lineGap*r.count),i=(h=this._customSize[t])>0?h:this._itemSize.height}else n=this._bottomGap+(this._itemSize.height+this._lineGap)*t,i=this._itemSize.height;var d;if(o=n+i,this.lackCenter)o+=d=this.content.height/2-this._allItemSizeNoEdge/2,n+=d;return{id:t,top:o,bottom:n,x:this._itemTmp.x,y:n+this._itemTmp.anchorY*i}}case cc.Layout.Type.GRID:var _=Math.floor(t/this._colLineNum);switch(this._startAxis){case cc.Layout.AxisDirection.HORIZONTAL:switch(this._verticalDir){case cc.Layout.VerticalDirection.TOP_TO_BOTTOM:l=(n=(o=-this._topGap-(this._itemSize.height+this._lineGap)*_)-this._itemSize.height)+this._itemTmp.anchorY*this._itemSize.height;break;case cc.Layout.VerticalDirection.BOTTOM_TO_TOP:o=(n=this._bottomGap+(this._itemSize.height+this._lineGap)*_)+this._itemSize.height,l=n+this._itemTmp.anchorY*this._itemSize.height}switch(a=this._leftGap+t%this._colLineNum*(this._itemSize.width+this._columnGap),this._horizontalDir){case cc.Layout.HorizontalDirection.LEFT_TO_RIGHT:a+=this._itemTmp.anchorX*this._itemSize.width,a-=this.content.anchorX*this.content.width;break;case cc.Layout.HorizontalDirection.RIGHT_TO_LEFT:a+=(1-this._itemTmp.anchorX)*this._itemSize.width,a-=(1-this.content.anchorX)*this.content.width,a*=-1}return{id:t,top:o,bottom:n,x:a,y:l};case cc.Layout.AxisDirection.VERTICAL:switch(this._horizontalDir){case cc.Layout.HorizontalDirection.LEFT_TO_RIGHT:c=(s=this._leftGap+(this._itemSize.width+this._columnGap)*_)+this._itemSize.width,a=s+this._itemTmp.anchorX*this._itemSize.width,a-=this.content.anchorX*this.content.width;break;case cc.Layout.HorizontalDirection.RIGHT_TO_LEFT:a=(s=(c=-this._rightGap-(this._itemSize.width+this._columnGap)*_)-this._itemSize.width)+this._itemTmp.anchorX*this._itemSize.width,a+=(1-this.content.anchorX)*this.content.width}switch(l=-this._topGap-t%this._colLineNum*(this._itemSize.height+this._lineGap),this._verticalDir){case cc.Layout.VerticalDirection.TOP_TO_BOTTOM:l-=(1-this._itemTmp.anchorY)*this._itemSize.height,l+=(1-this.content.anchorY)*this.content.height;break;case cc.Layout.VerticalDirection.BOTTOM_TO_TOP:l-=this._itemTmp.anchorY*this._itemSize.height,l+=this.content.anchorY*this.content.height,l*=-1}return{id:t,left:s,right:c,x:a,y:l}}}},e.prototype._calcExistItemPos=function(t){var e=this.getItemByListId(t);if(!e)return null;var i={id:t,x:e.x,y:e.y};return this._sizeType?(i.top=e.y+e.height*(1-e.anchorY),i.bottom=e.y-e.height*e.anchorY):(i.left=e.x-e.width*e.anchorX,i.right=e.x+e.width*(1-e.anchorX)),i},e.prototype.getItemPos=function(t){return this._virtual?this._calcItemPos(t):this.frameByFrameRenderNum?this._calcItemPos(t):this._calcExistItemPos(t)},e.prototype._getFixedSize=function(t){if(!this._customSize)return null;null==t&&(t=this._numItems);var e=0,i=0;for(var o in this._customSize)parseInt(o)<t&&(e+=this._customSize[o],i++);return{val:e,count:i}},e.prototype._onScrollBegan=function(){this._beganPos=this._sizeType?this.viewTop:this.viewLeft},e.prototype._onScrollEnded=function(){var t=this;if(null!=t.scrollToListId){var e=t.getItemByListId(t.scrollToListId);t.scrollToListId=null,e&&e.runAction(cc.sequence(cc.scaleTo(.1,1.06),cc.scaleTo(.1,1)))}t._onScrolling(),t._slideMode!=n.ADHERING||t.adhering?t._slideMode==n.PAGE&&(null!=t._beganPos?this._pageAdhere():t.adhere()):t.adhere()},e.prototype._onTouchStart=function(t,e){if(!this._scrollView._hasNestedViewGroup(t,e)&&!(t.eventPhase===cc.Event.AT_TARGET&&t.target===this.node)){for(var i=t.target;null==i._listId&&i.parent;)i=i.parent;this._scrollItem=null!=i._listId?i:t.target}},e.prototype._onTouchUp=function(){var t=this;t._scrollPos=null,t._slideMode==n.ADHERING?(this.adhering&&(this._adheringBarrier=!0),t.adhere()):t._slideMode==n.PAGE&&(null!=t._beganPos?this._pageAdhere():t.adhere()),this._scrollItem=null},e.prototype._onTouchCancelled=function(t,e){var i=this;i._scrollView._hasNestedViewGroup(t,e)||t.simulate||(i._scrollPos=null,i._slideMode==n.ADHERING?(i.adhering&&(i._adheringBarrier=!0),i.adhere()):i._slideMode==n.PAGE&&(null!=i._beganPos?i._pageAdhere():i.adhere()),this._scrollItem=null)},e.prototype._onSizeChanged=function(){this.checkInited(!1)&&this._onScrolling()},e.prototype._onItemAdaptive=function(t){if(!this._sizeType&&t.width!=this._itemSize.width||this._sizeType&&t.height!=this._itemSize.height){this._customSize||(this._customSize={});var e=this._sizeType?t.height:t.width;this._customSize[t._listId]!=e&&(this._customSize[t._listId]=e,this._resizeContent(),this.updateAll(),null!=this._scrollToListId&&(this._scrollPos=null,this.unschedule(this._scrollToSo),this.scrollTo(this._scrollToListId,Math.max(0,this._scrollToEndTime-(new Date).getTime()/1e3))))}},e.prototype._pageAdhere=function(){var t=this;if(t.cyclic||!(t.elasticTop>0||t.elasticRight>0||t.elasticBottom>0||t.elasticLeft>0)){var e=t._sizeType?t.viewTop:t.viewLeft,i=(t._sizeType?t.node.height:t.node.width)*t.pageDistance;if(Math.abs(t._beganPos-e)>i){switch(t._alignCalcType){case 1:case 4:t._beganPos>e?t.prePage(.5):t.nextPage(.5);break;case 2:case 3:t._beganPos<e?t.prePage(.5):t.nextPage(.5)}}else t.elasticTop<=0&&t.elasticRight<=0&&t.elasticBottom<=0&&t.elasticLeft<=0&&t.adhere();t._beganPos=null}},e.prototype.adhere=function(){var t=this;if(t.checkInited()&&!(t.elasticTop>0||t.elasticRight>0||t.elasticBottom>0||t.elasticLeft>0)){t.adhering=!0,t._calcNearestItem();var e=(t._sizeType?t._topGap:t._leftGap)/(t._sizeType?t.node.height:t.node.width);t.scrollTo(t.nearestListId,.7,e)}},e.prototype.update=function(){if(!(this.frameByFrameRenderNum<=0||this._updateDone))if(this._virtual){for(var t=this._updateCounter+this.frameByFrameRenderNum>this.displayItemNum?this.displayItemNum:this._updateCounter+this.frameByFrameRenderNum,e=this._updateCounter;e<t;e++){var i=this.displayData[e];i&&this._createOrUpdateItem(i)}this._updateCounter>=this.displayItemNum-1?this._doneAfterUpdate?(this._updateCounter=0,this._updateDone=!1,this._doneAfterUpdate=!1):(this._updateDone=!0,this._delRedundantItem(),this._forceUpdate=!1,this._calcNearestItem(),this.slideMode==n.PAGE&&(this.curPageNum=this.nearestListId)):this._updateCounter+=this.frameByFrameRenderNum}else if(this._updateCounter<this._numItems){for(t=this._updateCounter+this.frameByFrameRenderNum>this._numItems?this._numItems:this._updateCounter+this.frameByFrameRenderNum,e=this._updateCounter;e<t;e++)this._createOrUpdateItem2(e);this._updateCounter+=this.frameByFrameRenderNum}else this._updateDone=!0,this._calcNearestItem(),this.slideMode==n.PAGE&&(this.curPageNum=this.nearestListId)},e.prototype._createOrUpdateItem=function(t){var e=this.getItemByListId(t.id);if(e)this._forceUpdate&&this.renderEvent&&(e.setPosition(cc.v2(t.x,t.y)),this._resetItemSize(e),this.renderEvent&&cc.Component.EventHandler.emitEvents([this.renderEvent],e,t.id%this._actualNumItems));else{var i=this._pool.size()>0;if((e=i?this._pool.get():cc.instantiate(this._itemTmp))._listId!=t.id&&(e._listId=t.id,e.setContentSize(this._itemSize)),e.setPosition(cc.v2(t.x,t.y)),this._resetItemSize(e),this.content.addChild(e),i&&this._needUpdateWidget){var o=e.getComponent(cc.Widget);o&&o.updateAlignment()}e.setSiblingIndex(this.content.childrenCount-1);var n=e.getComponent(u.default);e.listItem=n,n&&(n.listId=t.id,n.list=this,n._registerEvent()),this.renderEvent&&cc.Component.EventHandler.emitEvents([this.renderEvent],e,t.id%this._actualNumItems)}this._resetItemSize(e),this._updateListItem(e.listItem),this._lastDisplayData.indexOf(t.id)<0&&this._lastDisplayData.push(t.id)},e.prototype._createOrUpdateItem2=function(t){var e,i=this.content.children[t];i?this._forceUpdate&&this.renderEvent&&(i._listId=t,e&&(e.listId=t),this.renderEvent&&cc.Component.EventHandler.emitEvents([this.renderEvent],i,t)):((i=cc.instantiate(this._itemTmp))._listId=t,this.content.addChild(i),e=i.getComponent(u.default),i.listItem=e,e&&(e.listId=t,e.list=this,e._registerEvent()),this.renderEvent&&cc.Component.EventHandler.emitEvents([this.renderEvent],i,t)),this._updateListItem(e),this._lastDisplayData.indexOf(t)<0&&this._lastDisplayData.push(t)},e.prototype._updateListItem=function(t){if(t&&this.selectedMode>s.NONE){var e=t.node;switch(this.selectedMode){case s.SINGLE:t.selected=this.selectedId==e._listId;break;case s.MULT:t.selected=this.multSelected.indexOf(e._listId)>=0}}},e.prototype._resetItemSize=function(t){},e.prototype._updateItemPos=function(t){var e=isNaN(t)?t:this.getItemByListId(t),i=this.getItemPos(e._listId);e.setPosition(i.x,i.y)},e.prototype.setMultSelected=function(t,e){var i=this;if(i.checkInited()){if(Array.isArray(t)||(t=[t]),null==e)i.multSelected=t;else{var o=void 0,n=void 0;if(e)for(var s=t.length-1;s>=0;s--)o=t[s],(n=i.multSelected.indexOf(o))<0&&i.multSelected.push(o);else for(s=t.length-1;s>=0;s--)o=t[s],(n=i.multSelected.indexOf(o))>=0&&i.multSelected.splice(n,1)}i._forceUpdate=!0,i._onScrolling()}},e.prototype.updateItem=function(t){if(this.checkInited()){Array.isArray(t)||(t=[t]);for(var e=0,i=t.length;e<i;e++){var o=t[e],n=this.getItemByListId(o);n&&cc.Component.EventHandler.emitEvents([this.renderEvent],n,o%this._actualNumItems)}}},e.prototype.updateAll=function(){this.checkInited()&&(this.numItems=this.numItems)},e.prototype.getItemByListId=function(t){if(this.content)for(var e=this.content.childrenCount-1;e>=0;e--){var i=this.content.children[e];if(i._listId==t)return i}},e.prototype._getOutsideItem=function(){for(var t,e=[],i=this.content.childrenCount-1;i>=0;i--)t=this.content.children[i],this.displayData.find(function(e){return e.id==t._listId})||e.push(t);return e},e.prototype._delRedundantItem=function(){if(this._virtual)for(var t=this._getOutsideItem(),e=t.length-1;e>=0;e--){var i=t[e];if(!this._scrollItem||i._listId!=this._scrollItem._listId){this._pool.put(i);for(var o=this._lastDisplayData.length-1;o>=0;o--)if(this._lastDisplayData[o]==i._listId){this._lastDisplayData.splice(o,1);break}}}else for(;this.content.childrenCount>this._numItems;)this._delSingleItem(this.content.children[this.content.childrenCount-1])},e.prototype._delSingleItem=function(t){t.removeFromParent(),t.destroy&&t.destroy(),t=null},e.prototype.aniDelItem=function(t,e,i){var o=this;if(!o.checkInited()||o.cyclic||!o._virtual)return cc.error("This function is not allowed to be called!");if(o._aniDelRuning)return cc.warn("Please wait for the current deletion to finish!");var n,c=o.getItemByListId(t);if(c){n=c.getComponent(u.default),o._aniDelRuning=!0;var a=o.displayData[o.displayData.length-1].id,l=n.selected;n.showAni(i,function(){var i;if(a<o._numItems-2&&(i=a+1),null!=i){var n=o._calcItemPos(i);o.displayData.push(n),o._virtual?o._createOrUpdateItem(n):o._createOrUpdateItem2(i)}else o._numItems--;if(o.selectedMode==s.SINGLE)l?o._selectedId=-1:o._selectedId-1>=0&&o._selectedId--;else if(o.selectedMode==s.MULT&&o.multSelected.length){var r=o.multSelected.indexOf(t);r>=0&&o.multSelected.splice(r,1);for(var h=o.multSelected.length-1;h>=0;h--){(u=o.multSelected[h])>=t&&o.multSelected[h]--}}if(o._customSize){o._customSize[t]&&delete o._customSize[t];var d={},_=void 0;for(var u in o._customSize){_=o._customSize[u];var p=parseInt(u);d[p-(p>=t?1:0)]=_}o._customSize=d}var m,f;for(h=null!=i?i:a;h>=t+1;h--)if(c=o.getItemByListId(h)){var y=o._calcItemPos(h-1);m=[cc.moveTo(.2333,cc.v2(y.x,y.y))],h<=t+1&&(f=!0,m.push(cc.callFunc(function(){o._aniDelRuning=!1,e(t)}))),m.length>1?c.runAction(cc.sequence(m)):c.runAction(m[0])}f||(o._aniDelRuning=!1,e(t))},!0)}else e(t)},e.prototype.scrollTo=function(t,e,i,o){void 0===e&&(e=.5),void 0===i&&(i=null),void 0===o&&(o=!1);var n=this;if(n.checkInited(!1)){null==e?e=.5:e<0&&(e=0),t<0?t=0:t>=n._numItems&&(t=n._numItems-1),!n._virtual&&n._layout&&n._layout.enabled&&n._layout.updateLayout();var s,c,a=n.getItemPos(t);switch(n._alignCalcType){case 1:s=a.left,s-=null!=i?n.node.width*i:n._leftGap,a=cc.v2(s,0);break;case 2:s=a.right-n.node.width,s+=null!=i?n.node.width*i:n._rightGap,a=cc.v2(s+n.content.width,0);break;case 3:c=a.top,c+=null!=i?n.node.height*i:n._topGap,a=cc.v2(0,-c);break;case 4:c=a.bottom+n.node.height,c-=null!=i?n.node.height*i:n._bottomGap,a=cc.v2(0,-c+n.content.height)}var l=n.content.getPosition();l=Math.abs(n._sizeType?l.y:l.x);var r=n._sizeType?a.y:a.x;Math.abs((null!=n._scrollPos?n._scrollPos:l)-r)>.5&&(n._scrollView.scrollToOffset(a,e),n._scrollToListId=t,n._scrollToEndTime=(new Date).getTime()/1e3+e,n._scrollToSo=n.scheduleOnce(function(){if(n._adheringBarrier||(n.adhering=n._adheringBarrier=!1),n._scrollPos=n._scrollToListId=n._scrollToEndTime=n._scrollToSo=null,o){var e=n.getItemByListId(t);e&&e.runAction(cc.sequence(cc.scaleTo(.1,1.05),cc.scaleTo(.1,1)))}},e+.1),e<=0&&n._onScrolling())}},e.prototype._calcNearestItem=function(){var t,e,i,o,n,s,c=this;c.nearestListId=null,c._virtual&&c._calcViewPos(),i=c.viewTop,o=c.viewRight,n=c.viewBottom,s=c.viewLeft;for(var a=!1,l=0;l<c.content.childrenCount&&!a;l+=c._colLineNum)if(t=c._virtual?c.displayData[l]:c._calcExistItemPos(l))switch(e=c._sizeType?(t.top+t.bottom)/2:e=(t.left+t.right)/2,c._alignCalcType){case 1:t.right>=s&&(c.nearestListId=t.id,s>e&&(c.nearestListId+=c._colLineNum),a=!0);break;case 2:t.left<=o&&(c.nearestListId=t.id,o<e&&(c.nearestListId+=c._colLineNum),a=!0);break;case 3:t.bottom<=i&&(c.nearestListId=t.id,i<e&&(c.nearestListId+=c._colLineNum),a=!0);break;case 4:t.top>=n&&(c.nearestListId=t.id,n>e&&(c.nearestListId+=c._colLineNum),a=!0)}if((t=c._virtual?c.displayData[c.displayItemNum-1]:c._calcExistItemPos(c._numItems-1))&&t.id==c._numItems-1)switch(e=c._sizeType?(t.top+t.bottom)/2:e=(t.left+t.right)/2,c._alignCalcType){case 1:o>e&&(c.nearestListId=t.id);break;case 2:s<e&&(c.nearestListId=t.id);break;case 3:n<e&&(c.nearestListId=t.id);break;case 4:i>e&&(c.nearestListId=t.id)}},e.prototype.prePage=function(t){void 0===t&&(t=.5),this.checkInited()&&this.skipPage(this.curPageNum-1,t)},e.prototype.nextPage=function(t){void 0===t&&(t=.5),this.checkInited()&&this.skipPage(this.curPageNum+1,t)},e.prototype.skipPage=function(t,e){var i=this;if(i.checkInited())return i._slideMode!=n.PAGE?cc.error("This function is not allowed to be called, Must SlideMode = PAGE!"):void(t<0||t>=i._numItems||i.curPageNum!=t&&(i.curPageNum=t,i.pageChangeEvent&&cc.Component.EventHandler.emitEvents([i.pageChangeEvent],t),i.scrollTo(t,e)))},e.prototype.calcCustomSize=function(t){var e=this;if(e.checkInited()){if(!e._itemTmp)return cc.error("Unset template item!");if(!e.renderEvent)return cc.error("Unset Render-Event!");e._customSize={};var i=cc.instantiate(e._itemTmp);e.content.addChild(i);for(var o=0;o<t;o++)cc.Component.EventHandler.emitEvents([e.renderEvent],i,o),i.height==e._itemSize.height&&i.width==e._itemSize.width||(e._customSize[o]=e._sizeType?i.height:i.width);return Object.keys(e._customSize).length||(e._customSize=null),i.removeFromParent(),i.destroy&&i.destroy(),e._customSize}},__decorate([l({type:cc.Enum(o),tooltip:!1})],e.prototype,"templateType",void 0),__decorate([l({type:cc.Node,tooltip:!1,visible:function(){return this.templateType==o.NODE}})],e.prototype,"tmpNode",void 0),__decorate([l({type:cc.Prefab,tooltip:!1,visible:function(){return this.templateType==o.PREFAB}})],e.prototype,"tmpPrefab",void 0),__decorate([l()],e.prototype,"_slideMode",void 0),__decorate([l({type:cc.Enum(n),tooltip:!1})],e.prototype,"slideMode",null),__decorate([l({type:cc.Float,range:[0,1,.1],tooltip:!1,slide:!0,visible:function(){return this._slideMode==n.PAGE}})],e.prototype,"pageDistance",void 0),__decorate([l({type:cc.Component.EventHandler,tooltip:!1,visible:function(){return this._slideMode==n.PAGE}})],e.prototype,"pageChangeEvent",void 0),__decorate([l()],e.prototype,"_virtual",void 0),__decorate([l({type:cc.Boolean,tooltip:!1})],e.prototype,"virtual",null),__decorate([l({tooltip:!1,visible:function(){var t=this.virtual&&this.slideMode==n.NORMAL;return t||(this.cyclic=!1),t}})],e.prototype,"cyclic",void 0),__decorate([l({tooltip:!1,visible:function(){return this.virtual}})],e.prototype,"lackCenter",void 0),__decorate([l({tooltip:!1,visible:function(){var t=this.virtual&&!this.lackCenter;return t||(this.lackSlide=!1),t}})],e.prototype,"lackSlide",void 0),__decorate([l({type:cc.Integer})],e.prototype,"_updateRate",void 0),__decorate([l({type:cc.Integer,range:[0,6,1],tooltip:!1,slide:!0})],e.prototype,"updateRate",null),__decorate([l({type:cc.Integer,range:[0,12,1],tooltip:!1,slide:!0})],e.prototype,"frameByFrameRenderNum",void 0),__decorate([l({type:cc.Component.EventHandler,tooltip:!1})],e.prototype,"renderEvent",void 0),__decorate([l({type:cc.Enum(s),tooltip:!1})],e.prototype,"selectedMode",void 0),__decorate([l({tooltip:!1,visible:function(){return this.selectedMode==s.SINGLE}})],e.prototype,"repeatEventSingle",void 0),__decorate([l({type:cc.Component.EventHandler,tooltip:!1,visible:function(){return this.selectedMode>s.NONE}})],e.prototype,"selectedEvent",void 0),__decorate([l({serializable:!1})],e.prototype,"_numItems",void 0),e=__decorate([a,r(),h("\u81ea\u5b9a\u4e49\u7ec4\u4ef6/List"),_(cc.ScrollView),d(-5e3)],e)}(cc.Component);i.default=p,cc._RF.pop()},{"./ListItem":"ListItem"}],Main:[function(t,e,i){"use strict";cc._RF.push(e,"a1e3dLTURRGxp0+7fBhyAoN","Main"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("./Common/SubTools"),n=cc._decorator,s=n.ccclass,c=n.property,a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._subTools=new o.default,e._initTime=0,e._userInfo=null,e.towerFriendRankNode=null,e.towerOverRankNode=null,e}var i;return __extends(e,t),i=e,e.prototype.onLoad=function(){console.log()},e.prototype.isNext=function(){var t=!1;return this._initTime>0?t=!0:console.error("\u5b50\u57df\u6ca1\u6709\u521d\u59cb\u5316, \u8bf7\u5148\u521d\u59cb\u5316msgType\u4e3a1"),t},e.prototype.initKey=function(t){i.towerFriendRankKay+=t?"_Online":"_Test"},e.prototype.getFriendRankData=function(t){this._subTools.getFriendCloudStorage(i.towerFriendRankKay,function(e){i.friendRankData=e,"function"==typeof t&&t()})},e.prototype.getOverData=function(t){var e=new Array;if(t||(t=0),i.friendRankData.length){for(var o=0;o<i.friendRankData.length;o++){if((n=i.friendRankData[o].KVDataList[0]).value<t&&n.avatarUrl!=this._userInfo.avatarUrl){e.push(n);break}}for(o=0;o<i.friendRankData.length;o++){var n;if((n=i.friendRankData[o].KVDataList[0]).value>t&&n.avatarUrl!=this._userInfo.avatarUrl){e.push(n);break}}}return e},e.towerFriendRankKay="towerFriendRank",e.friendRankData=new Array,__decorate([c(cc.Node)],e.prototype,"towerFriendRankNode",void 0),__decorate([c(cc.Node)],e.prototype,"towerOverRankNode",void 0),e=i=__decorate([s],e)}(cc.Component);i.default=a,cc._RF.pop()},{"./Common/SubTools":"SubTools"}],RankKeyConfig:[function(t,e,i){"use strict";cc._RF.push(e,"d29e0f25rFHubllkP3EtAOX","RankKeyConfig"),Object.defineProperty(i,"__esModule",{value:!0});var o=function(){function t(){}return t.historyRank="history_rank",t.friendRank="friend_rank",t}();i.default=o,cc._RF.pop()},{}],RankTools:[function(t,e,i){"use strict";cc._RF.push(e,"13f98qPPm5EkYQCnJuVtAXq","RankTools"),Object.defineProperty(i,"__esModule",{value:!0});var o=function(){function t(){}return t.getInstance=function(){return this.instance||(this.instance=new t),this.instance},t}();i.default=o,cc._RF.pop()},{}],SubTools:[function(t,e,i){"use strict";cc._RF.push(e,"0c6f3gwqF9PwYscMzIvSgSg","SubTools"),Object.defineProperty(i,"__esModule",{value:!0});var o=cc._decorator,n=o.ccclass,s=(o.property,function(){function t(){}return t.setUserCloudStorage=function(t,e,i){window.wx.setUserCloudStorage({KVDataList:[{key:t,value:e}],success:function(o){console.log("\u6258\u7ba1\u6570\u636e\u6210\u529f,key\u4e3a:",t,"\u6570\u636evakue\u4e3a:",e),"function"==typeof i&&i(o)},fail:function(t){},complete:function(t){}})},t.setUserCloudUpdateTime=function(t){var e=(new Date).valueOf().toString();t+="_UpdateTime",this.setUserCloudStorage(t,e,function(){console.log("\u8bbe\u7f6e\u6392\u884c\u699c\u65f6\u95f4\u9509\u6210\u529f","key==>",t,"\u65f6\u95f4\u9509===>",e)})},t.getUserCloudStorage=function(t,e){window.wx.getUserCloudStorage({keyList:[t],success:function(i){"function"==typeof e&&e(i),console.log("\u6258\u7ba1\u6570\u636e\u83b7\u53d6\u6210\u529f, key\u4e3a:",t)},fail:function(t){},complete:function(t){}})},t.getFriendCloudStorage=function(t,e){window.wx.getFriendCloudStorage({keyList:[t],success:function(i){var o=i.data;o.sort(function(t,e){return 0==t.KVDataList.length&&0==e.KVDataList.length?0:0==t.KVDataList.length?1:0==e.KVDataList.length?-1:e.KVDataList[0].value-t.KVDataList[0].value}),console.log("\u83b7\u53d6key\u4e3a:",t,"\u7684\u597d\u53cb\u6570\u636e==>",o);for(var n=[],s=0;s<o.length;s++)o[s].KVDataList[0]&&o[s].KVDataList[0].value&&n.push(o[s]);console.log("\u597d\u53cb\u6570\u636e 2\u6b21\u7b5b\u9009",n),"function"==typeof e&&e(n)},fail:function(t){}})},t.removeUserCloudStorage=function(t,e){window.wx.removeUserCloudStorage({keyList:[t],success:function(i){"function"==typeof e&&e(),console.log("\u79fb\u9664\u6258\u7ba1\u6570\u636e, key\u4e3a:"+t)},fail:function(t){}})},t.getUserInfo=function(t){window.wx.getUserInfo({openIdList:["selfOpenId"],success:function(e){t(e)}})},t.getFriendList=function(t){window.wx.getPotentialFriendList({success:function(e){console.log("\u83b7\u53d6\u597d\u53cb\u5217\u8868",e.list),"function"==typeof t&&t(e.list)},fail:function(t){console.error("\u83b7\u53d6\u597d\u53cb\u6570\u636e\u5931\u8d25====>",t)}})},t.loadTexture=function(t,e){var i=t;if("string"==typeof e&&e){var o=e;cc.loader.load({url:o,type:"png"},function(e,o){if(!e){if(!t||!t.parent||!t.isValid)return;var n=new cc.SpriteFrame(o);i&&(i.getComponent(cc.Sprite).spriteFrame=n)}})}else console.error("\u6ca1\u6709\u83b7\u53d6\u5230\u597d\u53cb\u5934\u50cf\u5730\u5740",e),i.getComponent(cc.Sprite).spriteFrame=null},t=__decorate([n],t)}());i.default=s,cc._RF.pop()},{}],Test:[function(t,e,i){"use strict";cc._RF.push(e,"11b69Wc9jpAr5h1unrzXyzn","Test"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){console.log("\u5b50\u57df\u52a0\u8f7d\u4e86")},start:function(){}}),cc._RF.pop()},{}],TowerFriendRankCtrl:[function(t,e,i){"use strict";cc._RF.push(e,"63718uDJ+hHy4RfuwctXa9H","TowerFriendRankCtrl"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("./Common/list/List"),n=t("./Common/list/ListItem"),s=t("./Main"),c=t("./Common/SubTools"),a=cc._decorator,l=a.ccclass,r=a.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.listCtrl=null,e._subTools=new c.default,e.upNode=null,e.amidNode=null,e.downNode=null,e}return __extends(e,t),e.prototype.init=function(){this.updateUp(),this.updateList()},e.prototype.updateUp=function(){for(var t=0;t<3;t++){var e=s.default.friendRankData[t],i=this.upNode.children[t];e?(i.active=!0,i.getChildByName("score").getComponent(cc.Label).string=e.KVDataList[0].value+"",this._subTools.loadTexture(i.getChildByName("head"),e.avatarUrl)):i.active=!1}},e.prototype.updateDown=function(){var t=this.downNode.getChildByName("towerRankItem");t.getChildByName("lv"),t.getChildByName("name"),t.getChildByName("score"),t.getChildByName("head"),this._subTools.getUserInfo(function(t){console.log("\u83b7\u53d6\u73a9\u5bb6\u81ea\u8eab\u4fe1\u606f===>",t)})},e.prototype.updateList=function(){this.listCtrl.numItems=s.default.friendRankData.length},e.prototype.onListVRender=function(t,e){var i=s.default.friendRankData[e+3];i&&(t.getComponent(n.default).title.getComponent(cc.Label).string=i.nickname,t.getComponent(n.default).lv.string=e+4+"",t.getComponent(n.default).title.getComponent(cc.Label).string=i.KVDataList[0].value+"",this._subTools.loadTexture(t.getComponent(n.default).icon.node,i.avatarUrl))},e.prototype.openRank=function(){this.node.active=!0,this.updateUp(),this.updateList()},e.prototype.closeRank=function(){this.node.active=!1},__decorate([r(o.default)],e.prototype,"listCtrl",void 0),__decorate([r(cc.Node)],e.prototype,"upNode",void 0),__decorate([r(cc.Node)],e.prototype,"amidNode",void 0),__decorate([r(cc.Node)],e.prototype,"downNode",void 0),e=__decorate([l],e)}(cc.Component);i.default=h,cc._RF.pop()},{"./Common/SubTools":"SubTools","./Common/list/List":"List","./Common/list/ListItem":"ListItem","./Main":"Main"}],TowerFriendRankItem:[function(t,e,i){"use strict";cc._RF.push(e,"6255aayTVVPp4dklDFKdHA4","TowerFriendRankItem"),Object.defineProperty(i,"__esModule",{value:!0});var o=t("./Common/list/ListItem"),n=cc._decorator,s=n.ccclass,c=n.property,a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.lvLabel=null,e.scoreLabel=null,e}return __extends(e,t),__decorate([c(cc.Label)],e.prototype,"lvLabel",void 0),__decorate([c(cc.Label)],e.prototype,"scoreLabel",void 0),e=__decorate([s],e)}(o.default);i.default=a,cc._RF.pop()},{"./Common/list/ListItem":"ListItem"}],TowerOverRankCtrl:[function(t,e,i){"use strict";cc._RF.push(e,"4f357S+pOJMwKMmuXfRbwOd","TowerOverRankCtrl"),Object.defineProperty(i,"__esModule",{value:!0});var o=cc._decorator,n=o.ccclass,s=(o.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.open=function(){this.node.active=!0;for(var t=0;t<3;t++){var e=this.node.children[t];0==t?(e.getChildByName("head"),e.getChildByName("score")):1==t&&(e.getChildByName("head"),e.getChildByName("score"))}console.log()},e.prototype.close=function(){this.node.active=!1},e=__decorate([n],e)}(cc.Component));i.default=s,cc._RF.pop()},{}],use_reversed_rotateTo:[function(t,e,i){"use strict";cc._RF.push(e,"19018MdhEVLf5ybtqs+Kru9","use_reversed_rotateTo"),cc.RotateTo._reverse=!0,cc._RF.pop()},{}],"use_v2.1-2.2.1_cc.Toggle_event":[function(t,e,i){"use strict";cc._RF.push(e,"68502NDP8hD+4f70wpkXU84","use_v2.1-2.2.1_cc.Toggle_event"),cc.Toggle&&(cc.Toggle._triggerEventInScript_isChecked=!0),cc._RF.pop()},{}]},{},["use_reversed_rotateTo","use_v2.1-2.2.1_cc.Toggle_event","RankTools","SubTools","List","ListItem","RankKeyConfig","BasePanel","Demo","FriendRankPanel","InvitePanel","Test","Main","TowerFriendRankCtrl","TowerFriendRankItem","TowerOverRankCtrl"]);