var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /**This class is automatically generated by LayaAirIDE, please do not make any modifications. */


var _game_app = require("./scripts/game_app");

var _game_app2 = _interopRequireDefault(_game_app);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var GameConfig = function () {
    function GameConfig() {
        _classCallCheck(this, GameConfig);
    }

    _createClass(GameConfig, null, [{
        key: "init",
        value: function init() {
            //注册Script或者Runtime引用
            var reg = Laya.ClassUtils.regClass;
            reg("scripts/game_app.js", _game_app2.default);
        }
    }]);

    return GameConfig;
}();

exports.default = GameConfig;

GameConfig.width = 960;
GameConfig.height = 640;
GameConfig.scaleMode = "fixedheight";
GameConfig.screenMode = "none";
GameConfig.alignV = "top";
GameConfig.alignH = "left";
GameConfig.startScene = "game.scene";
GameConfig.sceneRoot = "";
GameConfig.debug = false;
GameConfig.stat = false;
GameConfig.physicsDebug = false;
GameConfig.exportSceneToJson = true;

GameConfig.init();

},{"./scripts/game_app":4}],2:[function(require,module,exports){
"use strict";

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _GameConfig = require("./GameConfig");

var _GameConfig2 = _interopRequireDefault(_GameConfig);

var _layaMaxUI = require("./ui/layaMaxUI");

var _layaMaxUI2 = _interopRequireDefault(_layaMaxUI);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var Main = function () {
	function Main() {
		_classCallCheck(this, Main);

		//根据IDE设置初始化引擎		
		if (window["Laya3D"]) Laya3D.init(_GameConfig2.default.width, _GameConfig2.default.height);else Laya.init(_GameConfig2.default.width, _GameConfig2.default.height, Laya["WebGL"]);
		Laya["Physics"] && Laya["Physics"].enable();
		Laya["DebugPanel"] && Laya["DebugPanel"].enable();
		Laya.stage.scaleMode = _GameConfig2.default.scaleMode;
		Laya.stage.screenMode = _GameConfig2.default.screenMode;
		Laya.stage.alignV = _GameConfig2.default.alignV;
		Laya.stage.alignH = _GameConfig2.default.alignH;
		//兼容微信不支持加载scene后缀场景
		Laya.URL.exportSceneToJson = _GameConfig2.default.exportSceneToJson;

		//打开调试面板（通过IDE设置调试模式，或者url地址增加debug=true参数，均可打开调试面板）
		if (_GameConfig2.default.debug || Laya.Utils.getQueryString("debug") == "true") Laya.enableDebugPanel();
		if (_GameConfig2.default.physicsDebug && Laya["PhysicsDebugDraw"]) Laya["PhysicsDebugDraw"].enable();
		if (_GameConfig2.default.stat) Laya.Stat.show();
		Laya.alertGlobalError = true;

		//激活资源版本控制，version.json由IDE发布功能自动生成，如果没有也不影响后续流程
		Laya.ResourceVersion.enable("version.json", Laya.Handler.create(this, this.onVersionLoaded), Laya.ResourceVersion.FILENAME_VERSION);
	}

	_createClass(Main, [{
		key: "onVersionLoaded",
		value: function onVersionLoaded() {
			//激活大小图映射，加载小图的时候，如果发现小图在大图合集里面，则优先加载大图合集，而不是小图
			Laya.AtlasInfoManager.enable("fileconfig.json", Laya.Handler.create(this, this.onConfigLoaded));
		}
	}, {
		key: "onConfigLoaded",
		value: function onConfigLoaded() {
			//加载IDE指定的场景
			_GameConfig2.default.startScene && Laya.Scene.open(_GameConfig2.default.startScene);
		}
	}]);

	return Main;
}();
//激活启动类


new Main();

},{"./GameConfig":1,"./ui/layaMaxUI":5}],3:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

var State = {
    Idle: 1,
    AddForce: 2,
    ThrowOut: 3,
    CheckOut: 4
};

var ball_ctrl = function (_Laya$Script3D) {
    _inherits(ball_ctrl, _Laya$Script3D);

    function ball_ctrl() {
        _classCallCheck(this, ball_ctrl);

        return _possibleConstructorReturn(this, (ball_ctrl.__proto__ || Object.getPrototypeOf(ball_ctrl)).call(this));
    }

    _createClass(ball_ctrl, [{
        key: "onAwake",
        value: function onAwake() {
            this.body = this.owner.getComponent(Laya.Rigidbody3D);
            this.body.overrideGravity = true;
            this.body.gravity = new Laya.Vector3(0, 0, 0);

            this.state = State.Idle;
            this.group_speed = 2 / 3; // 
            this.add_speed = 0;

            Laya.stage.on(Laya.Event.MOUSE_DOWN, this, this.on_click_down);
            Laya.stage.on(Laya.Event.MOUSE_UP, this, this.on_click_up);
        }
    }, {
        key: "on_click_down",
        value: function on_click_down() {
            if (this.state != State.Idle) {
                return;
            }

            this.state = State.AddForce;
        }
    }, {
        key: "throw_ball",
        value: function throw_ball() {
            var speed = 4.5 + this.add_speed; // [4.5, 6.5]
            this.body.overrideGravity = true;
            this.body.gravity = new Laya.Vector3(0, -10, 0);

            var degree = 45;
            var vy = speed * Math.sin(45 * Math.PI / 180);
            var vz = speed * Math.cos(45 * Math.PI / 180);

            this.body.linearVelocity = new Laya.Vector3(0, vy, vz);

            Laya.timer.once(5000, this, this.destroy_self);
        }
    }, {
        key: "destroy_self",
        value: function destroy_self() {
            this.state = State.CheckOut;

            this.owner.removeSelf();

            Laya.stage.event("new_next_ball", null);
        }
    }, {
        key: "on_click_up",
        value: function on_click_up() {
            if (this.state != State.AddForce) {
                return;
            }

            this.state = State.ThrowOut;
            this.throw_ball();
        }
    }, {
        key: "onStart",
        value: function onStart() {}
    }, {
        key: "onUpdate",
        value: function onUpdate() {
            if (this.state != State.AddForce) {
                return;
            }

            var dt = Laya.timer.delta / 1000; // Time.deltaTime
            this.add_speed += this.group_speed * dt;

            if (this.add_speed >= 2) {
                this.add_speed = 2;
            }

            var per = this.add_speed / 2;
            per = per > 1 ? 1 : per;

            Laya.stage.event("update_per", per);
        }
    }, {
        key: "onTriggerEnter",
        value: function onTriggerEnter(other) {
            Laya.stage.event("goal", null);
        }
    }, {
        key: "onDestroy",
        value: function onDestroy() {
            Laya.stage.off(Laya.Event.MOUSE_DOWN, this, this.on_click_down);
            Laya.stage.off(Laya.Event.MOUSE_UP, this, this.on_click_up);
        }
    }]);

    return ball_ctrl;
}(Laya.Script3D);

exports.default = ball_ctrl;

},{}],4:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _ball_ctrl = require("./ball_ctrl");

var _ball_ctrl2 = _interopRequireDefault(_ball_ctrl);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

var game_app = function (_Laya$Script) {
    _inherits(game_app, _Laya$Script);

    // MonoBehaviour
    /** @prop {name:progress_bar, tips:"进度条", type:Node, default:null}*/

    function game_app() {
        _classCallCheck(this, game_app);

        var _this = _possibleConstructorReturn(this, (game_app.__proto__ || Object.getPrototypeOf(game_app)).call(this));

        _this.progress_bar = null;
        return _this;
    }

    _createClass(game_app, [{
        key: "onAwake",
        value: function onAwake() {
            // this ---> 当前组件实例;
            // this.gameObejct --->所在节点---> this.owener;
            this.set_per(0);
            Laya.stage.on("update_per", this, this.set_per);
            Laya.stage.on("goal", this, this.on_goal_event);
            Laya.stage.on("new_next_ball", this, this.on_new_ball);
            Laya.Scene3D.load("res/scene3D/LayaScene_game/Conventional/game.ls", Laya.Handler.create(this, this.on_scene3D_loaded));
        }
    }, {
        key: "on_new_ball",
        value: function on_new_ball() {
            var ball = Laya.Sprite3D.instantiate(this.ball_prefab);
            this.scene3d.addChild(ball);
            this.set_per(0);
        }
    }, {
        key: "on_goal_event",
        value: function on_goal_event() {
            this.ps.play();
        }
    }, {
        key: "set_per",
        value: function set_per(per) {
            if (per < 0 || per > 1) {
                return;
            }

            var width = per * 136;
            this.progress_bar.width = width;
        }
    }, {
        key: "on_scene3D_loaded",
        value: function on_scene3D_loaded(scene3d) {
            Laya.stage.addChild(scene3d);
            scene3d.zOrder = -1;
            this.scene3d = scene3d;

            var ps = scene3d.getChildByName("Particle").particleSystem;
            ps.stop();
            this.ps = ps;
            var ball = scene3d.getChildByName("ball");
            ball.addComponent(_ball_ctrl2.default);

            this.ball_prefab = Laya.Sprite3D.instantiate(ball);
        }
    }, {
        key: "onStart",
        value: function onStart() {}
    }, {
        key: "onUpdate",
        value: function onUpdate() {}
    }]);

    return game_app;
}(Laya.Script);

exports.default = game_app;

},{"./ball_ctrl":3}],5:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
/**This class is automatically generated by LayaAirIDE, please do not make any modifications. */
var CLASS$ = Laya.class;
var STATICATTR$ = Laya.static;
var View = laya.ui.View;
var Dialog = laya.ui.Dialog;
var Scene = Laya.Scene;
if (!window.ui) window.ui = {};
exports.default = ui;

},{}]},{},[2])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3Rvb2xzL0xheWFBaXJJREUvcmVzb3VyY2VzL2FwcC9ub2RlX21vZHVsZXMvYnJvd3Nlci1wYWNrL19wcmVsdWRlLmpzIiwic3JjL0dhbWVDb25maWcuanMiLCJzcmMvTWFpbi5qcyIsInNyYy9zY3JpcHRzL2JhbGxfY3RybC5qcyIsInNyYy9zY3JpcHRzL2dhbWVfYXBwLmpzIiwic3JjL3VpL2xheWFNYXhVSS5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7O3FqQkNWQTs7O0FBQ0E7Ozs7Ozs7O0lBRXFCLFU7Ozs7Ozs7K0JBQ0g7QUFDVjtBQUNBLGdCQUFJLE1BQU0sS0FBSyxVQUFMLENBQWdCLFFBQTFCO0FBQ04sZ0JBQUkscUJBQUosRUFBMEIsa0JBQTFCO0FBQ0c7Ozs7OztrQkFMZ0IsVTs7QUFPckIsV0FBVyxLQUFYLEdBQW1CLEdBQW5CO0FBQ0EsV0FBVyxNQUFYLEdBQW9CLEdBQXBCO0FBQ0EsV0FBVyxTQUFYLEdBQXNCLGFBQXRCO0FBQ0EsV0FBVyxVQUFYLEdBQXdCLE1BQXhCO0FBQ0EsV0FBVyxNQUFYLEdBQW9CLEtBQXBCO0FBQ0EsV0FBVyxNQUFYLEdBQW9CLE1BQXBCO0FBQ0EsV0FBVyxVQUFYLEdBQXdCLFlBQXhCO0FBQ0EsV0FBVyxTQUFYLEdBQXVCLEVBQXZCO0FBQ0EsV0FBVyxLQUFYLEdBQW1CLEtBQW5CO0FBQ0EsV0FBVyxJQUFYLEdBQWtCLEtBQWxCO0FBQ0EsV0FBVyxZQUFYLEdBQTBCLEtBQTFCO0FBQ0EsV0FBVyxpQkFBWCxHQUErQixJQUEvQjs7QUFFQSxXQUFXLElBQVg7Ozs7Ozs7QUN2QkM7Ozs7QUFDRDs7Ozs7Ozs7SUFDTSxJO0FBQ0wsaUJBQWM7QUFBQTs7QUFDYjtBQUNBLE1BQUksT0FBTyxRQUFQLENBQUosRUFBc0IsT0FBTyxJQUFQLENBQVkscUJBQVcsS0FBdkIsRUFBOEIscUJBQVcs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QWUsT0FBTyxFQUFQLEdBQVUsRUFBVjtRQUNELE8sR0FBTixFIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgX19leHRlbmRzID0gKHRoaXMgJiYgdGhpcy5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxyXG4gICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcclxuICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTtcclxuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikge1xyXG4gICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XHJcbiAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XHJcbiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xyXG4gICAgfTtcclxufSkoKTtcclxuKGZ1bmN0aW9uKCl7ZnVuY3Rpb24gcihlLG4sdCl7ZnVuY3Rpb24gbyhpLGYpe2lmKCFuW2ldKXtpZighZVtpXSl7dmFyIGM9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZTtpZighZiYmYylyZXR1cm4gYyhpLCEwKTtpZih1KXJldHVybiB1KGksITApO3ZhciBhPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIraStcIidcIik7dGhyb3cgYS5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGF9dmFyIHA9bltpXT17ZXhwb3J0czp7fX07ZVtpXVswXS5jYWxsKHAuZXhwb3J0cyxmdW5jdGlvbihyKXt2YXIgbj1lW2ldWzFdW3JdO3JldHVybiBvKG58fHIpfSxwLHAuZXhwb3J0cyxyLGUsbix0KX1yZXR1cm4gbltpXS5leHBvcnRzfWZvcih2YXIgdT1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlLGk9MDtpPHQubGVuZ3RoO2krKylvKHRbaV0pO3JldHVybiBvfXJldHVybiByfSkoKSIsIi8qKlRoaXMgY2xhc3MgaXMgYXV0b21hdGljYWxseSBnZW5lcmF0ZWQgYnkgTGF5YUFpcklERSwgcGxlYXNlIGRvIG5vdCBtYWtlIGFueSBtb2RpZmljYXRpb25zLiAqL1xyXG5pbXBvcnQgZ2FtZV9hcHAgZnJvbSBcIi4vc2NyaXB0cy9nYW1lX2FwcFwiXHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBHYW1lQ29uZmlnIHtcclxuICAgIHN0YXRpYyBpbml0KCkge1xyXG4gICAgICAgIC8v5rOo5YaMU2NyaXB05oiW6ICFUnVudGltZeW8leeUqFxyXG4gICAgICAgIGxldCByZWcgPSBMYXlhLkNsYXNzVXRpbHMucmVnQ2xhc3M7XHJcblx0XHRyZWcoXCJzY3JpcHRzL2dhbWVfYXBwLmpzXCIsZ2FtZV9hcHApO1xyXG4gICAgfVxyXG59XHJcbkdhbWVDb25maWcud2lkdGggPSA5NjA7XHJcbkdhbWVDb25maWcuaGVpZ2h0ID0gNjQwO1xyXG5HYW1lQ29uZmlnLnNjYWxlTW9kZSA9XCJmaXhlZGhlaWdodFwiO1xyXG5HYW1lQ29uZmlnLnNjcmVlbk1vZGUgPSBcIm5vbmVcIjtcclxuR2FtZUNvbmZpZy5hbGlnblYgPSBcInRvcFwiO1xyXG5HYW1lQ29uZmlnLmFsaWduSCA9IFwibGVmdFwiO1xyXG5HYW1lQ29uZmlnLnN0YXJ0U2NlbmUgPSBcImdhbWUuc2NlbmVcIjtcclxuR2FtZUNvbmZpZy5zY2VuZVJvb3QgPSBcIlwiO1xyXG5HYW1lQ29uZmlnLmRlYnVnID0gZmFsc2U7XHJcbkdhbWVDb25maWcuc3RhdCA9IGZhbHNlO1xyXG5HYW1lQ29uZmlnLnBoeXNpY3NEZWJ1ZyA9IGZhbHNlO1xyXG5HYW1lQ29uZmlnLmV4cG9ydFNjZW5lVG9Kc29uID0gdHJ1ZTtcclxuXHJcbkdhbWVDb25maWcuaW5pdCgpO1xyXG4iLCLvu79pbXBvcnQgR2FtZUNvbmZpZyBmcm9tIFwiLi9HYW1lQ29uZmlnXCI7XHJcbmltcG9ydCB1aSBmcm9tIFwiLi91aS9sYXlhTWF4VUlcIjtcclxuY2xhc3MgTWFpbiB7XHJcblx0Y29uc3RydWN0b3IoKSB7XHJcblx0XHQvL+agueaNrklEReiuvue9ruWIneWni+WMluW8leaTjlx0XHRcclxuXHRcdGlmICh3aW5kb3dbXCJMYXlhM0RcIl0pIExheWEzRC5pbml0KEdhbWVDb25maWcud2lkdGgsIEdhbWVDb25maWcuaGVpZ2h0KTtcclxuXHRcdGVsc2UgTGF5YS5pbml0KEdhbWVDb25maWcud2lkdGgsIEdhbWVDb25maWcuaGVpZ2h0LCBMYXlhW1wiV2ViR0xcIl0pO1xyXG5cdFx0TGF5YVtcIlBoeXNpY3NcIl0gJiYgTGF5YVtcIlBoeXNpY3NcIl0uZW5hYmxlKCk7XHJcblx0XHRMYXlhW1wiRGVidWdQYW5lbFwiXSAmJiBMYXlhW1wiRGVidWdQYW5lbFwiXS5lbmFibGUoKTtcclxuXHRcdExheWEuc3RhZ2Uuc2NhbGVNb2RlID0gR2FtZUNvbmZpZy5zY2FsZU1vZGU7XHJcblx0XHRMYXlhLnN0YWdlLnNjcmVlbk1vZGUgPSBHYW1lQ29uZmlnLnNjcmVlbk1vZGU7XHJcblx0XHRMYXlhLnN0YWdlLmFsaWduViA9IEdhbWVDb25maWcuYWxpZ25WO1xyXG5cdFx0TGF5YS5zdGFnZS5hbGlnbkggPSBHYW1lQ29uZmlnLmFsaWduSDtcclxuXHRcdC8v5YW85a655b6u5L+h5LiN5pSv5oyB5Yqg6L29c2NlbmXlkI7nvIDlnLrmma9cclxuXHRcdExheWEuVVJMLmV4cG9ydFNjZW5lVG9Kc29uID0gR2FtZUNvbmZpZy5leHBvcnRTY2VuZVRvSnNvbjtcclxuXHJcblx0XHQvL+aJk+W8gOiwg+ivlemdouadv++8iOmAmui/h0lEReiuvue9ruiwg+ivleaooeW8j++8jOaIluiAhXVybOWcsOWdgOWinuWKoGRlYnVnPXRydWXlj4LmlbDvvIzlnYflj6/miZPlvIDosIPor5XpnaLmnb/vvIlcclxuXHRcdGlmIChHYW1lQ29uZmlnLmRlYnVnIHx8IExheWEuVXRpbHMuZ2V0UXVlcnlTdHJpbmcoXCJkZWJ1Z1wiKSA9PSBcInRydWVcIikgTGF5YS5lbmFibGVEZWJ1Z1BhbmVsKCk7XHJcblx0XHRpZiAoR2FtZUNvbmZpZy5waHlzaWNzRGVidWcgJiYgTGF5YVtcIlBoeXNpY3NEZWJ1Z0RyYXdcIl0pIExheWFbXCJQaHlzaWNzRGVidWdEcmF3XCJdLmVuYWJsZSgpO1xyXG5cdFx0aWYgKEdhbWVDb25maWcuc3RhdCkgTGF5YS5TdGF0LnNob3coKTtcclxuXHRcdExheWEuYWxlcnRHbG9iYWxFcnJvciA9IHRydWU7XHJcblxyXG5cdFx0Ly/mv4DmtLvotYTmupDniYjmnKzmjqfliLbvvIx2ZXJzaW9uLmpzb27nlLFJREXlj5HluIPlip/og73oh6rliqjnlJ/miJDvvIzlpoLmnpzmsqHmnInkuZ/kuI3lvbHlk43lkI7nu63mtYHnqItcclxuXHRcdExheWEuUmVzb3VyY2VWZXJzaW9uLmVuYWJsZShcInZlcnNpb24uanNvblwiLCBMYXlhLkhhbmRsZXIuY3JlYXRlKHRoaXMsIHRoaXMub25WZXJzaW9uTG9hZGVkKSwgTGF5YS5SZXNvdXJjZVZlcnNpb24uRklMRU5BTUVfVkVSU0lPTik7XHJcblx0fVxyXG5cclxuXHRvblZlcnNpb25Mb2FkZWQoKSB7XHJcblx0XHQvL+a/gOa0u+Wkp+Wwj+WbvuaYoOWwhO+8jOWKoOi9veWwj+WbvueahOaXtuWAme+8jOWmguaenOWPkeeOsOWwj+WbvuWcqOWkp+WbvuWQiOmbhumHjOmdou+8jOWImeS8mOWFiOWKoOi9veWkp+WbvuWQiOmbhu+8jOiAjOS4jeaYr+Wwj+WbvlxyXG5cdFx0TGF5YS5BdGxhc0luZm9NYW5hZ2VyLmVuYWJsZShcImZpbGVjb25maWcuanNvblwiLCBMYXlhLkhhbmRsZXIuY3JlYXRlKHRoaXMsIHRoaXMub25Db25maWdMb2FkZWQpKTtcclxuXHR9XHJcblxyXG5cdG9uQ29uZmlnTG9hZGVkKCkge1xyXG5cdFx0Ly/liqDovb1JREXmjIflrprnmoTlnLrmma9cclxuXHRcdEdhbWVDb25maWcuc3RhcnRTY2VuZSAmJiBMYXlhLlNjZW5lLm9wZW4oR2FtZUNvbmZpZy5zdGFydFNjZW5lKTtcclxuXHR9XHJcbn1cclxuLy/mv4DmtLvlkK/liqjnsbtcclxubmV3IE1haW4oKTtcclxuIiwiXHJcbnZhciBTdGF0ZSA9IHtcclxuICAgIElkbGU6IDEsXHJcbiAgICBBZGRGb3JjZTogMixcclxuICAgIFRocm93T3V0OiAzLFxyXG4gICAgQ2hlY2tPdXQ6IDQsXHJcbn07XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBiYWxsX2N0cmwgZXh0ZW5kcyBMYXlhLlNjcmlwdDNEIHtcclxuXHJcbiAgICBjb25zdHJ1Y3RvcigpIHsgXHJcbiAgICAgICAgc3VwZXIoKTsgXHJcbiAgICB9XHJcbiAgICBcclxuICAgIG9uQXdha2UoKSB7XHJcbiAgICAgICAgdGhpcy5ib2R5ID0gdGhpcy5vd25lci5nZXRDb21wb25lbnQoTGF5YS5SaWdpZGJvZHkzRCk7XHJcbiAgICAgICAgdGhpcy5ib2R5Lm92ZXJyaWRlR3Jhdml0eSA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5ib2R5LmdyYXZpdHkgPSBuZXcgTGF5YS5WZWN0b3IzKDAsIDAsIDApO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHRoaXMuc3RhdGUgPSBTdGF0ZS5JZGxlO1xyXG4gICAgICAgIHRoaXMuZ3JvdXBfc3BlZWQgPSAyIC8gMzsgLy8gXHJcbiAgICAgICAgdGhpcy5hZGRfc3BlZWQgPSAwO1xyXG5cclxuICAgICAgICBMYXlhLnN0YWdlLm9uKExheWEuRXZlbnQuTU9VU0VfRE9XTiwgdGhpcywgdGhpcy5vbl9jbGlja19kb3duKTtcclxuICAgICAgICBMYXlhLnN0YWdlLm9uKExheWEuRXZlbnQuTU9VU0VfVVAsIHRoaXMsIHRoaXMub25fY2xpY2tfdXApO1xyXG4gICAgfVxyXG5cclxuICAgIG9uX2NsaWNrX2Rvd24oKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuc3RhdGUgIT0gU3RhdGUuSWRsZSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLnN0YXRlID0gU3RhdGUuQWRkRm9yY2U7XHJcbiAgICB9XHJcblxyXG4gICAgdGhyb3dfYmFsbCgpIHtcclxuICAgICAgICB2YXIgc3BlZWQgPSA0LjUgKyB0aGlzLmFkZF9zcGVlZDsgLy8gWzQuNSwgNi41XVxyXG4gICAgICAgIHRoaXMuYm9keS5vdmVycmlkZUdyYXZpdHkgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuYm9keS5ncmF2aXR5ID0gbmV3IExheWEuVmVjdG9yMygwLCAtMTAsIDApO1xyXG5cclxuXHJcbiAgICAgICAgdmFyIGRlZ3JlZSA9IDQ1O1xyXG4gICAgICAgIHZhciB2eSA9IHNwZWVkICogTWF0aC5zaW4oNDUgKiBNYXRoLlBJIC8gMTgwKTsgXHJcbiAgICAgICAgdmFyIHZ6ID0gc3BlZWQgKiBNYXRoLmNvcyg0NSAqIE1hdGguUEkgLyAxODApOyBcclxuXHJcbiAgICAgICAgdGhpcy5ib2R5LmxpbmVhclZlbG9jaXR5ID0gbmV3IExheWEuVmVjdG9yMygwLCB2eSwgdnopO1xyXG5cclxuICAgICAgICBMYXlhLnRpbWVyLm9uY2UoNTAwMCwgdGhpcywgdGhpcy5kZXN0cm95X3NlbGYpO1xyXG4gICAgfVxyXG5cclxuICAgIGRlc3Ryb3lfc2VsZigpIHtcclxuICAgICAgICB0aGlzLnN0YXRlID0gU3RhdGUuQ2hlY2tPdXQ7XHJcblxyXG4gICAgICAgIHRoaXMub3duZXIucmVtb3ZlU2VsZigpO1xyXG5cclxuICAgICAgICBMYXlhLnN0YWdlLmV2ZW50KFwibmV3X25leHRfYmFsbFwiLCBudWxsKTtcclxuICAgIH1cclxuXHJcbiAgICBvbl9jbGlja191cCgpIHtcclxuICAgICAgICBpZiAodGhpcy5zdGF0ZSAhPSBTdGF0ZS5BZGRGb3JjZSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLnN0YXRlID0gU3RhdGUuVGhyb3dPdXQ7XHJcbiAgICAgICAgdGhpcy50aHJvd19iYWxsKCk7XHJcbiAgICB9XHJcblxyXG4gICAgb25TdGFydCgpIHtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgb25VcGRhdGUoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuc3RhdGUgIT0gU3RhdGUuQWRkRm9yY2UpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIGR0ID0gTGF5YS50aW1lci5kZWx0YSAvIDEwMDA7IC8vIFRpbWUuZGVsdGFUaW1lXHJcbiAgICAgICAgdGhpcy5hZGRfc3BlZWQgKz0gKHRoaXMuZ3JvdXBfc3BlZWQgKiBkdCk7XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmFkZF9zcGVlZCA+PSAyKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYWRkX3NwZWVkID0gMjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBwZXIgPSB0aGlzLmFkZF9zcGVlZCAvIDI7XHJcbiAgICAgICAgcGVyID0gKHBlciA+IDEpID8gMSA6IHBlcjtcclxuXHJcbiAgICAgICAgTGF5YS5zdGFnZS5ldmVudChcInVwZGF0ZV9wZXJcIiwgcGVyKTtcclxuICAgIH1cclxuXHJcbiAgICBvblRyaWdnZXJFbnRlcihvdGhlcikge1xyXG4gICAgICAgIExheWEuc3RhZ2UuZXZlbnQoXCJnb2FsXCIsIG51bGwpO1xyXG4gICAgfVxyXG5cclxuICAgIG9uRGVzdHJveSgpIHtcclxuICAgICAgICBMYXlhLnN0YWdlLm9mZihMYXlhLkV2ZW50Lk1PVVNFX0RPV04sIHRoaXMsIHRoaXMub25fY2xpY2tfZG93bik7XHJcbiAgICAgICAgTGF5YS5zdGFnZS5vZmYoTGF5YS5FdmVudC5NT1VTRV9VUCwgdGhpcywgdGhpcy5vbl9jbGlja191cCk7XHJcbiAgICB9XHJcbn0iLCJpbXBvcnQgYmFsbF9jdHJsIGZyb20gXCIuL2JhbGxfY3RybFwiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgZ2FtZV9hcHAgZXh0ZW5kcyBMYXlhLlNjcmlwdCB7IC8vIE1vbm9CZWhhdmlvdXJcclxuICAgIC8qKiBAcHJvcCB7bmFtZTpwcm9ncmVzc19iYXIsIHRpcHM6XCLov5vluqbmnaFcIiwgdHlwZTpOb2RlLCBkZWZhdWx0Om51bGx9Ki9cclxuXHJcbiAgICBjb25zdHJ1Y3RvcigpIHsgXHJcbiAgICAgICAgc3VwZXIoKTsgXHJcbiAgICAgICAgdGhpcy5wcm9ncmVzc19iYXIgPSBudWxsO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBvbkF3YWtlKCkge1xyXG4gICAgICAgIC8vIHRoaXMgLS0tPiDlvZPliY3nu4Tku7blrp7kvos7XHJcbiAgICAgICAgLy8gdGhpcy5nYW1lT2JlamN0IC0tLT7miYDlnKjoioLngrktLS0+IHRoaXMub3dlbmVyO1xyXG4gICAgICAgIHRoaXMuc2V0X3BlcigwKTtcclxuICAgICAgICBMYXlhLnN0YWdlLm9uKFwidXBkYXRlX3BlclwiLCB0aGlzLCB0aGlzLnNldF9wZXIpO1xyXG4gICAgICAgIExheWEuc3RhZ2Uub24oXCJnb2FsXCIsIHRoaXMsIHRoaXMub25fZ29hbF9ldmVudCk7XHJcbiAgICAgICAgTGF5YS5zdGFnZS5vbihcIm5ld19uZXh0X2JhbGxcIiwgdGhpcywgdGhpcy5vbl9uZXdfYmFsbCk7XHJcbiAgICAgICAgTGF5YS5TY2VuZTNELmxvYWQoXCJyZXMvc2NlbmUzRC9MYXlhU2NlbmVfZ2FtZS9Db252ZW50aW9uYWwvZ2FtZS5sc1wiLCBMYXlhLkhhbmRsZXIuY3JlYXRlKHRoaXMsIHRoaXMub25fc2NlbmUzRF9sb2FkZWQpKTtcclxuICAgICAgICBcclxuICAgIH1cclxuXHJcbiAgICBvbl9uZXdfYmFsbCgpIHtcclxuICAgICAgICB2YXIgYmFsbCA9IExheWEuU3ByaXRlM0QuaW5zdGFudGlhdGUodGhpcy5iYWxsX3ByZWZhYik7XHJcbiAgICAgICAgdGhpcy5zY2VuZTNkLmFkZENoaWxkKGJhbGwpO1xyXG4gICAgICAgIHRoaXMuc2V0X3BlcigwKTtcclxuICAgIH1cclxuXHJcbiAgICBvbl9nb2FsX2V2ZW50KCkge1xyXG4gICAgICAgIHRoaXMucHMucGxheSgpO1xyXG4gICAgfVxyXG5cclxuICAgIHNldF9wZXIocGVyKSB7XHJcbiAgICAgICAgaWYgKHBlciA8IDAgfHwgcGVyID4gMSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgd2lkdGggPSBwZXIgKiAxMzY7XHJcbiAgICAgICAgdGhpcy5wcm9ncmVzc19iYXIud2lkdGggPSB3aWR0aDtcclxuICAgIH1cclxuXHJcbiAgICBvbl9zY2VuZTNEX2xvYWRlZChzY2VuZTNkKSB7XHJcbiAgICAgICAgTGF5YS5zdGFnZS5hZGRDaGlsZChzY2VuZTNkKTtcclxuICAgICAgICBzY2VuZTNkLnpPcmRlciA9IC0xO1xyXG4gICAgICAgIHRoaXMuc2NlbmUzZCA9IHNjZW5lM2Q7XHJcblxyXG4gICAgICAgIHZhciBwcyA9IHNjZW5lM2QuZ2V0Q2hpbGRCeU5hbWUoXCJQYXJ0aWNsZVwiKS5wYXJ0aWNsZVN5c3RlbTtcclxuICAgICAgICBwcy5zdG9wKCk7XHJcbiAgICAgICAgdGhpcy5wcyA9IHBzO1xyXG4gICAgICAgIHZhciBiYWxsID0gc2NlbmUzZC5nZXRDaGlsZEJ5TmFtZShcImJhbGxcIik7XHJcbiAgICAgICAgYmFsbC5hZGRDb21wb25lbnQoYmFsbF9jdHJsKTtcclxuXHJcbiAgICAgICAgdGhpcy5iYWxsX3ByZWZhYiA9IExheWEuU3ByaXRlM0QuaW5zdGFudGlhdGUoYmFsbCk7XHJcbiAgICB9XHJcblxyXG4gICAgb25TdGFydCgpIHtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgb25VcGRhdGUoKSB7XHJcblxyXG4gICAgfVxyXG59IiwiLyoqVGhpcyBjbGFzcyBpcyBhdXRvbWF0aWNhbGx5IGdlbmVyYXRlZCBieSBMYXlhQWlySURFLCBwbGVhc2UgZG8gbm90IG1ha2UgYW55IG1vZGlmaWNhdGlvbnMuICovXHJcbnZhciBDTEFTUyQ9TGF5YS5jbGFzcztcclxudmFyIFNUQVRJQ0FUVFIkPUxheWEuc3RhdGljO1xudmFyIFZpZXc9bGF5YS51aS5WaWV3O1xyXG52YXIgRGlhbG9nPWxheWEudWkuRGlhbG9nO1xyXG52YXIgU2NlbmU9TGF5YS5TY2VuZTtcbmlmKCF3aW5kb3cudWkpIHdpbmRvdy51aT17fTtcbmV4cG9ydCB7dWkgYXMgZGVmYXVsdH07Il19
